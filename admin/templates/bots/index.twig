{% extends "layout.twig" %}

{% block title %}Manage Bots{% endblock %}
{% block heading %}Bot Management{% endblock %}

{% block content %}
<div class="box">
    <div class="level">
        <div class="level-left">
            <h2 class="subtitle">Configured Bots</h2>
        </div>
        <div class="level-right">
            <a href="{{ url_for('bots.create') }}" class="button is-primary">
                <span class="icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </span>
                <span>Create New Bot</span>
            </a>
        </div>
    </div>

    <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable">
            <thead>
                <tr>
                    <th>Bot Name</th>
                    <th>Mention Name</th>
                    <th>Default Chat Model</th>
                    <th>Created At</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for bot in bots %}
                <tr>
                    <td>
                        <span class="icon-text">
                            <span class="icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                                </svg>
                            </span>
                            <a href="{{ url_for('bots.edit', {'id': bot.id}) }}" class="has-text-weight-semibold">{{ bot.bot_name }}</a>
                        </span>
                    </td>
                    <td><span class="tag is-info is-light">{{ bot.mention_name }}</span></td>
                    <td>{{ bot.default_model }}</td>
                    <td>{{ bot.created_at|date('Y-m-d H:i:s') }}</td>
                    <td>
                        <div class="buttons">
                            <a href="{{ url_for('bots.edit', {'id': bot.id}) }}" class="button is-link is-small">
                                <span class="icon">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                    </svg>
                                </span>
                                <span>Edit</span>
                            </a>
                            <form action="{{ url_for('bots.delete', {'id': bot.id}) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this bot and all its associated data? This cannot be undone.');">
                                <button type="submit" class="button is-danger is-small">
                                     <span class="icon">
                                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"/>
                                            <path d="m19,6 v14 a2,2 0 0,1 -2,2 H7 a2,2 0 0,1 -2,-2 V6 m3,0 V4 a2,2 0 0,1 2,-2 h4 a2,2 0 0,1 2,2 v2"/>
                                        </svg>
                                    </span>
                                    <span>Delete</span>
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="has-text-centered has-text-grey">No bots have been created yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %} 